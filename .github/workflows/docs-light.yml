name: docs-light
'on':
  pull_request:
    types:
    - opened
    - synchronize
    - reopened
    - ready_for_review
    paths:
    - README.md
    - CITATION.cff
    - .zenodo.json
    - .github/workflows/docs-light.yml
  workflow_dispatch: {}
permissions:
  contents: read
jobs:
  title-canon:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
      with:
        fetch-depth: 1
    - name: Verify canonical titles
      shell: bash
      run: "\nset -Eeuo pipefail\nTITLE=\"MCGT : Mod\xE8le de la Courbure Gravitationnelle du Temps\"\nERR=0\n# README\nif [ ! -f README.md ] || ! grep -qF \"$TITLE\" README.md; then\n  echo \"::error title=README non canonique::README.md ne contient pas le titre canonique\"; ERR=1\nfi\n# CITATION.cff\nif [ ! -f CITATION.cff ] || ! awk '/^title:/ {print; found=1} END{exit found?0:1}' CITATION.cff | grep -qF \"$TITLE\"; then\n  echo \"::error title=CITATION non canonique::CITATION.cff:title n est pas canonique\"; ERR=1\nfi\n# .zenodo.json (optionnel)\nif [ -f .zenodo.json ]; then\npython3 - <<'P2'\nimport json,io,sys\nT=\"MCGT : Mod\xE8le de la Courbure Gravitationnelle du Temps\"\ntry:\n  obj=json.load(io.open(\".zenodo.json\",\"r\",encoding=\"utf-8\"))\n  sys.exit(0 if obj.get(\"title\")==T else 2)\nexcept Exception:\n  sys.exit(2)\nP2\n  rc=$?; if [ $rc -ne 0 ]; then\n    echo \"::error title=Zenodo non canonique::.zenodo.json:title n est pas canonique\"; ERR=1\n  fi\nfi\nexit $ERR\n"
