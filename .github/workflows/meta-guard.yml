name: meta-guard
on:
concurrency:
  group: .github/workflows/meta-guard.yml-${{ github.ref }}
  cancel-in-progress: true
  push:
  pull_request:
jobs:
  export-ignore:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v5
      - name: Verify .ci-out is not in source archive
        run: |
          git archive -o /tmp/test.zip HEAD
          if unzip -l /tmp/test.zip | grep -q '\.ci-out/'; then
            echo "::error::.ci-out leaked into archive"
            exit 1
          fi
