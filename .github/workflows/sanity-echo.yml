name: "sanity-echo"
on:
  workflow_dispatch: {}
  repository_dispatch:
    types: [ping]
permissions:
  actions: write
  contents: read
jobs:
  echo:
    runs-on: ubuntu-latest
    steps:
      - name: Context & env
        shell: bash
        run: |
          set -x
          uname -a
          echo "event=$GITHUB_EVENT_NAME"
          echo "ref=$GITHUB_REF"
      - name: Prepare artifact
        shell: bash
        run: |
          mkdir -p .ci-out
          date -u +"%FT%TZ" > .ci-out/echo.ts
          printf '{"ok":true,"ts":"%s"}\n' "$(cat .ci-out/echo.ts)" > .ci-out/echo.json
      - name: Upload artifact
        uses: actions/upload-artifact@v4
        with:
          name: sanity-echo
          path: .ci-out/
          if-no-files-found: error
