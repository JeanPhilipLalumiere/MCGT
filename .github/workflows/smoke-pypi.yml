# added by policies_guard_common_fixes
permissions:
  contents: read
name: smoke-from-pypi
on:
  release:
    types: [published]

jobs:
  smoke:
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        python-version: ['3.9','3.10','3.11','3.12','3.13']
    steps:
      - uses: actions/setup-python@v5
        with:
          python-version: ${{ matrix.python-version }}
      - name: Install tagged version from PyPI
        run: |
          python -m pip install -U pip -c constraints/security-pins.txt
          VERSION="${GITHUB_REF_NAME#v}"
          python -m pip install --no-cache-dir "zz-tools==${VERSION}" -c constraints/security-pins.txt
      - name: Import smoke
        run: |
          python - <<'PY'
          import zz_tools, zz_tools.common_io as cio
          import numpy, pandas as pd
          print("zz_tools:", getattr(zz_tools, "__version__", "?"))
          print("numpy   :", numpy.__version__)
          print("pandas  :", pd.__version__)
          # Touch a public symbol to ensure module is loaded
          _ = [n for n in dir(cio) if not n.startswith("_")][:5]
          print("OK smoke")
          PY
