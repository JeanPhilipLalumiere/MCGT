###############################################################################
# scalar_perturbations.ini                -- Chapter 7 · Perturbations MCGT
# INI canonique du Chapter 7 (perturbations scalaires MCGT)
# Utilisé par :
#   - scripts/07_bao_geometry/generate_data_chapter07.py
#   - scripts/07_bao_geometry/launch_scalar_perturbations_solver.py
#   - scripts/07_bao_geometry/launch_solver_chapter07.sh
#   - zz-checklists/CHAPTER07_CHECKLIST.txt
#   - 07-perturbations-scalaires/CHAPTER07_GUIDE.txt
#   - config/mcgt-global-config.ini.template

###############################################################################
# Fichier de configuration *ASCII pur* (aucun caractère “multibyte” dans
# les nombres) utilisé par :
#   • scripts/07_bao_geometry/run_scalar_perturbations_solver.py
#   • scripts/07_bao_geometry/generate_chapter07_data.py
#   • mcgt/scalar_perturbations.py
#
# Remarque : tous les chemins pointent vers l’arborescence en anglais
#            (assets/zz-data/NN_chapter_name, scripts/chapterXX, assets/zz-figures/NN_chapter_name).
###############################################################################

###############################################################################
[solver]                        # Choix du Boltzmann solver
name                = camb      # camb | class (doit exister dans $PATH)
###############################################################################

#############################################
[cosmologie]                     ; Planck 2018 (flat-ΛCDM)
H0                  = 67.36      # km s^-1 Mpc^-1
ombh2               = 0.02237
omch2               = 0.1200
omk                 = 0.0
tau                 = 0.0544
mnu_eV              = 0.06       # Somme des masses de neutrinos (eV)
As0                 = 2.10e-9
ns0                 = 0.9649
#############################################

#############################################
[scan]                           ; « Knobs » Chapter 7
# --- vitesse du son c_s²(k) ---
cs2_param           = 1.0
k0                  = 0.10       # h Mpc^-1 (largeur gaussienne, échelle de référence)

# --- perturbation δφ/φ ---
delta_phi_param     = 5.0e-3     # amplitude des CI (k→0)
decay               = 0.1        # CI ∝ exp(-(k/k_split)^2), avec k_split = x_split (cf. [segmentation])

# --- fond du champ φ₀(a) ---
phi0_init           = 1.0
phi_inf             = 1.5
a_char              = 0.10
m_phi_eV            = 1.0e-33    # eV
m_eff_const_eV      = 1.0e-33    # eV
#############################################

#############################################
[grille1D]                       ; Grille log-uniforme en k
k_min_hMpc          = 1.0e-4     # h Mpc^-1
k_max_hMpc          = 1.0e+1
dlog_k              = 0.01
n_k                 = 0          # 0 ⇒ calculé depuis dlog_k et bornes
#############################################

#############################################
[grille2D]                       ; Grille en facteur d’échelle a
a_min               = 0.05
a_max               = 1.00
n_a                 = 20
#############################################

#############################################
[segmentation]
x_split_hMpc        = 0.02       # h Mpc^-1 (séparation low/high pour algos dérivés)
#############################################

#############################################
[lissage]                         ; Dérivées Savitzky–Golay
derivative_window    = 7
derivative_polyorder = 3
#############################################

#############################################
[tolerances]                      ; Interpolation / scan 1-D
primary             = 0.01
order2              = 0.10
#############################################

#############################################
[dynamique_phi]                   ; Φ(k,a) & gel progressif
a_eq                = 0.33       # ~1/(1+z_eq) ; z_eq≈3400
freeze_scale        = 1.0e5      # amortissement progressif
Phi0                = 1.0e-5     # Φ(k≈0, a≪a_eq)
#############################################

#############################################
[plot]                            ; Choix graphiques centralisés
vmin_log            = 1.0e-9     # pour LogNorm
vmax_log            = 5.0e-5
cmap                = viridis    # palette matplotlib standard (fallback robuste)
#############################################

#############################################
[sorties]
# Matrices principales (chemins anglicisés)
output_cs2          = assets/zz-data/07_bao_geometry/07_cs2_matrix.csv
output_delta_phi    = assets/zz-data/07_bao_geometry/07_delta_phi_matrix.csv
# Produits dérivés optionnels
output_dcs2_dk      = assets/zz-data/07_bao_geometry/07_dcs2_dk.csv
output_ddphi_dk     = assets/zz-data/07_bao_geometry/07_ddelta_phi_dk.csv
#############################################

#############################################
[format]
comment_char        = #
csv_separator       = ,
#############################################

#############################################
[repro]
write_meta_git_hash = true
random_seed         = 123456
#############################################

###############################################################################
# NOTES
# -----
# * Tous les ‘-’ dans les exposants sont des tirets ASCII (-).
# * Φ(k,a) ≈ Φ0 · exp(-(k/k_split)^2) / (1 + (a/a_eq)^3) avec k_split = x_split.
# * freeze_scale règle l’atténuation douce des modes profonds sous-horizon.
# * Les sorties et scripts référencés utilisent l’arborescence en anglais.
###############################################################################
