# MCGT — configuration globale
# Version : 1.1 — 2025-09-09

[global]
repo_root = .
default_lang = fr
write_meta_git_hash = true
log_level = INFO

[io]
zz_data    = zz-data
zz_figures = zz-figures
zz_scripts = zz-scripts
config_dir = zz-configuration
manifest_dir = zz-manifests
default_output_format = csv
# Politique d'écrasement par défaut (les jobs peuvent la surcharger)
no_overwrite = true

[thresholds]
# Seuils globaux de présentation
primary = 0.01
order2  = 0.10

[numerical]
float_tol = 1e-12
max_iter = 1000000
derivative_window = 7
derivative_polyorder = 3
wrap_epsilon = 1e-8

# ---------- Chapitres 1–2 : chronologie / P(T) ----------
[chronologie]
# Grilles et jalons par défaut
t_units = Gyr
t_jalons = 1e-6,1e-5,3.8e-4,1e-3,0.02,0.9,3.0,5.0,13.8
# Champs attendus (headers)
columns_jalons = T,P_ref,P_opt,epsilon_i,classe

# ---------- Chapitre 2 : spectre primordial ----------
[spectrum]
# Forme P_R(k;alpha) = A_s(alpha) * k^(n_s(alpha)-1)
As0 = 2.10e-9
ns0 = 0.9649
c1  = 0.10
c2  = 0.01

# ---------- Chapitre 3 : f(R) ----------
[fr_stability]
fR_target = 1.0
fRR_scale = 1e-6
ms2_over_R0_target = 333333.0
# Domaine (beta, gamma)
gamma_min = 0.0
gamma_max = 333333.0

# ---------- Chapitre 4 : invariants ----------
[invariants]
# Invariants adimensionnels (I1,I2,I3) — unités : sans dimension
require_fix_I3 = true  # drapeau de correction de l'expression I3

# ---------- Chapitre 5 : nucléosynthèse ----------
[nucleosynthesis]
# Seuils spécifiques (issus de 05_parametres_nucleosynthese.json)
max_epsilon_primary = 0.0085
max_epsilon_order2  = 0.00156
# Colonnes standards
columns_invariants = T_Gyr,I_DH,I_Yp

# ---------- Chapitre 6 : CMB ----------
[cmb]
H0    = 67.36
ombh2 = 0.02237
omch2 = 0.12
tau   = 0.0544
mnu   = 0.06
As0   = 2.1e-9
ns0   = 0.9649
ell_min = 2
ell_max = 3000
n_points = 3001
derivative_window    = 7
derivative_polyorder = 3
# (optionnel) borne constatée
max_delta_Cl_rel_allowed = 0.65
# Fichier CAMB par défaut (anglais)
camb_ini = zz-configuration/camb_plateau_exact.ini

# ---------- Chapitre 7 : perturbations scalaires ----------
[perturbations]
cs2_param = 1.0
delta_phi_param = 0.05
# Grille k (log)
k_min = 1e-4
k_max = 10.0
dlog  = 0.01
n_k   = 501
# Grille a (linéaire)
a_min = 0.05
a_max = 1.0
n_a   = 20
# Segments (découpage automatique selon x_split)
x_split = 0.02
k0 = 0.1
alpha = 0.5
# Seuils de présentation
thresholds_primary = 0.01
thresholds_order2  = 0.10
# Sorties (anglais)
output_dir = zz-data/chapter07

# ---------- Chapitre 8 : couplage sombre ----------
[coupling]
# Sources jalons (BAO/SN) : colonnes attendues
columns_jalons = jalon,z,obs,sigma_obs,classe
# Paramétrisation générique
param2_min = -1.0
param2_max = 1.0
n_param2   = 101

# ---------- Chapitre 9 : phases GW ----------
[gw_phase]
# Grille de fréquence (référence et MCGT)
fmin_Hz = 10.0
fmax_Hz = 2048.0
dlog10  = 0.01
n_points_default = 232
# Calibration (alignement)
calibration_enabled     = true
calibration_mode        = phi0,tc
calibration_fit_window  = 20,300
calibration_used_window = 30,250
calibration_weight      = 1/f2
tighten_threshold_p95_rad = 5.0
# Correction polynomiale (optionnelle)
poly_correction_degree = 5
poly_correction_basis  = log10
poly_fit_window_Hz     = 30,250
metrics_window_Hz      = 20,300
# Sorties par défaut (anglais)
outputs_dir       = zz-data/chapter09
jalons_filename   = 09_comparison_milestones.csv
# Méta obligatoires
write_meta_git_hash  = true

# ---------- Chapitre 10 : Monte Carlo global 8D ----------
[montecarlo]
sampler      = sobol
scramble     = true
sobol_seed   = 12345
sobol_offset = 0
n_samples_default = 5000

# Bornes (par défaut)
m1_bounds     = 5.0,80.0
m2_bounds     = 5.0,80.0
q0star_bounds = -0.3,0.3
alpha_bounds  = -1.0,1.0
phi0_bounds   = -3.141592653589793,3.141592653589793
tc_bounds     = -0.01,0.01
dist_bounds   = 50.0,2000.0
incl_bounds   = 0.0,3.141592653589793

# Priors (par défaut)
prior_m1     = uniform
prior_m2     = uniform
prior_q0star = uniform
prior_alpha  = uniform
prior_phi0   = fixed
prior_tc     = fixed
prior_dist   = fixed
prior_incl   = fixed

# Nuisances (par défaut)
nuisance_mode  = fixed
dist_value     = 1000.0
incl_value     = 0.0
vary_phi0_tc   = false

# Fenêtre de métriques (cohérente avec chap. 9)
metrics_window_Hz = 20,300
# Sorties (anglais)
mc_samples_path = zz-data/chapter10/10_mc_samples.csv
no_overwrite    = true

[bootstrap]
B    = 1000
seed = 12345
resid_dir = zz-data/chapter10/topk_residuals

# ---------- Visualisation ----------
[plots]
dpi = 150
figsize_default = 9,6
format = png
save_transparent = false

# ---------- Journalisation ----------
[logging]
logfile = logs/mcgt.log
level = INFO

# ---------- Validation (QA) ----------
[validation]
require_git_hash = true
check_units_phase_radians = true
check_p95_improves_after_cal = true
check_csv_headers_canonical = true
p95_target_rad = 5.0
